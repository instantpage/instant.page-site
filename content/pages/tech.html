<_page__tech__title>
Technical details
</_page__tech__title>

<_page__tech__description>
Preloading is done with &lt;link rel=&quot;prefetch&quot; href=&quot;url&quot;&gt;.
</_page__tech__description>

<_page__tech__content>
<h1 class="title">Technical details</h1>

<p>Preloading is done with &lt;link rel="prefetch" href="<em>url</em>"&gt;.</p>

<p>The <a href="https://github.com/instantpage/instant.page" data-instant>source code</a> is 200 readable lines.</p>

<h2 id="browser-support">Browser support</h2>

<p>instant.page is progressive enhancement — there’s no impact on browsers that don’t support it.</p>

<p>Chrome and Chromium-based browsers have full support since version 61 (shipped in September 2017).</p>

<p>Firefox supports &lt;link rel="prefetch"&gt; (since 2006!) but will redownload the page if it’s not cached (it’s a <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1527334" target="_blank">open bug</a>).</p>

<h3 id="unsupported-browsers">Incompatible browsers</h3>

<p>Safari 13.0 has support for &lt;link rel="prefetch"&gt; but it’s disabled by default. Hopefully it will be enabled in September 2020 in Safari 14.0.</p>

<p>UC Browser doesn’t support modules as it’s based on Chromium 57. A new version based on Chromium 69 which supports modules was <a href="https://developers.uc.cn/blog/open_uqvawd.html#%E4%B8%89%E3%80%81u4-3-0%E6%BC%94%E8%BF%9B%E5%92%8C%E5%BC%80%E5%8F%91%E8%80%85%E5%9F%BA%E5%BB%BA" target="_blank">announced in October 2018</a> but it has yet to ship.</p>

<h2 id="cdn">Secure CDN</h2>

<p>instant.page’s script is hosted serverless with <a href="https://workers.cloudflare.com/" target="_blank">Cloudflare Workers</a> so that there’s no server to hack into. <span class="footnote-button"></span></p>

<div class="footnote-content">
  <p>Cloudflare provided me with free Workers in order to be able to securely serve the script to a very large number of people.</p>
</div>

<p>Additionally, it uses <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity" target="_blank">subresource integrity</a> to let modern browsers verify that the file hasn’t been tampered with. It’s loaded as a module so that most old browsers won’t execute it. <span class="footnote-button"></span></p>

<div class="footnote-content">
  <p>The only browser versions that implement modules without implementing subresource integrity are Edge 16, Safari 10.1 and Safari 11.0. They account for 0.4% of page views.</p>
</div>

<h2 id="self-hosting">Self-hosting</h2>

<p>Hosting the script yourself is also possible. <a href="/{{VERSIONS_LATEST}}" download="instantpage-{{VERSIONS_LATEST}}.js">Download the latest version</a> then add a module script tag just before &lt;/body&gt;:</p>

<code class="code code--block">&lt;script src="instantpage-{{VERSIONS_LATEST}}.js" type="module" defer&gt;&lt;/script&gt;</code>

<p>You can also install it via npm: <code class="code">npm i instant.page</code></p>

<h2 id="history">History</h2>

<p>The idea of preloading web pages on hover and touchstart comes from an older library of mine, <a href="http://instantclick.io/" target="_blank">InstantClick</a>, launched in January 2014, which uses Ajax and <a href="https://developer.mozilla.org/en-US/docs/Web/API/History_API" target="_blank">history.pushState</a> instead of &lt;link rel="prefetch"&gt;, transforming a site into a single-page application. It makes a site even smoother but requires additional work.</p>

<p>InstantClick is unfortunately mostly just a proof of concept as it doesn’t have good documentation.</p>

<p>Google’s release of <a href="https://github.com/GoogleChromeLabs/quicklink" target="_blank">quicklink</a> in December 2018, which preloads links with &lt;link rel="prefetch"&gt; as soon as they are shown, made it clear that I should focus on building a “lite”, easier to use version of InstantClick, which is instant.page, launched in February 2019.</p>

<h2 id="future-projects">Future related project</h2>

<p>InstantClick provides the smoothest experience possible, while still not requiring as much work as a framework (who give lesser results), so I’m considering working on it again later in 2020. It will be renamed to “instant.page extra”.</p>

<include>cta-widget</include>
</_page__tech__content>
